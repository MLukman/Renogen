{% extends "base.twig" %}
{% import _self as r %}

{% block menubar %}
	{% if crumbs|length > 0 %}
		{% for crumb in crumbs %}
			{{ m.topmenu_item(crumb.text, crumb.url, crumb.icon, (loop.last ? 'active':null)) }}
		{% endfor %}
	{% endif %}
{% endblock %}

{% macro timestamps(entity) %}
	{% if entity.created_date %}
		<div class="ui label">
			Created
			<span class="detail"><i class="ui clock icon"></i>{{entity.created_date|date('d/m/Y h:ia')}}</span>
			<span class="detail"><i class="ui user icon"></i>{{entity.created_by.username|default('Anonymous')}}</span>
		</div>
	{% endif %}
	{% if entity.updated_date %}
		<div class="ui label">
			Updated 
			<span class="detail"><i class="ui clock icon"></i>{{entity.updated_date|date('d/m/Y h:ia')}}</span>
			<span class="detail"><i class="ui user icon"></i>{{entity.updated_by.username|default('Anonymous')}}</span>
		</div>
	{% endif %}
{% endmacro %}

{% macro itemStatusLabel(item, detailed) %}
	{% if item.approved_date %}
		<div class="ui green label">
			<i class="ui {{item.statusIcon}} icon"></i>
			{{item.status}}
			{% if detailed %}
				<span class="detail">
					<i class="ui clock icon"></i>{{item.approved_date|date('d/m/Y h:ia')}}
				</span>
				<span class="detail">
					<i class="ui user icon"></i>{{item.approved_by.username|default('Anonymous')}}
				</span>
			{% endif %}
		</div>
	{% else %}
		<div class="ui red label">
			<i class="ui {{item.statusIcon}} icon"></i>
			{{item.status}}
		</div>
	{% endif %}
{% endmacro %}

{% macro itemCategoryLabel(item) %}
	<span class="ui label">
		<i class="ui tag icon"></i>{{item.category}}
	</span>
{% endmacro %}

{% macro arrayTable(arr, child) %}
	{% import _self as r %}	
	<table class="ui compact {% if child %}small{% endif %} table">
		{% for key,val in arr %}
			<tr>
				<td class="top aligned right aligned collapsing">
					{% if not child %}
						<strong>{{key}}</strong>
					{% else %}
						{{key}}
					{% endif %}
				</td>
				<td class="ui top aligned">
					{% if val is empty %}
						{{'<blank>'|trim}}
					{% elseif val is iterable %}
						{{r.arrayTable(val, true)}}
					{% else %}
						{{val}}
					{% endif %}
				</td>
			</tr>
		{% endfor %}
	</table>
{% endmacro %}
